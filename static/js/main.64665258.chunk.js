(this["webpackJsonprelease-me"]=this["webpackJsonprelease-me"]||[]).push([[0],{26:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n.n(s),a=n(21),i=n.n(a),c=(n(26),n(5)),o=n(6),l=n(4),d=n(8),u=n(3),j=n(0),b=function(e){var t=e.setIsLoggedIn,n=e.setUserName,r=(e.setIsLoading,Object(s.useState)("")),a=Object(l.a)(r,2),i=a[0],c=a[1],o=Object(s.useState)(""),d=Object(l.a)(o,2),u=d[0],b=d[1],m=function(e){if(e.preventDefault(),"test_user"!==i||"demoPassword123"!==u){var s=document.querySelector("#login-notification");return s.style.maxHeight="100px",s.style.opacity=1,s.innerText="Incorrect credentials - please try again.",void setTimeout((function(){s.style.opacity=0,s.style.maxHeight="0"}),2e3)}var r="Test User";n(r),function(e,t,n){var s=Date.now()+2592e5;window.localStorage.setItem("accessToken",JSON.stringify({userId:t,expiry:s,token:e,userName:n}))}(12345,1,r),t(!0)};return Object(j.jsxs)("div",{id:"login-wrapper",children:[Object(j.jsx)("h2",{children:"Login"}),Object(j.jsxs)("form",{onSubmit:function(e){return m(e)},children:[Object(j.jsxs)("label",{htmlFor:"userid",children:["User ID",Object(j.jsx)("br",{}),Object(j.jsx)("input",{type:"text",id:"userid",name:"userid",value:i,onChange:function(e){return c(e.target.value)}})]}),Object(j.jsxs)("label",{htmlFor:"password",children:["Password",Object(j.jsx)("br",{}),Object(j.jsx)("input",{type:"password",id:"password",name:"password",value:u,onChange:function(e){return b(e.target.value)}})]}),Object(j.jsx)("input",{type:"submit",id:"login",name:"login",value:"Login"})]}),Object(j.jsx)("p",{id:"login-notification"})]})},m=function(e){var t=e.userName,n=(e.setIsLoading,Object(s.useState)("")),r=Object(l.a)(n,2),a=r[0],i=r[1];return window.addEventListener("click",(function(e){"logout"!==e.target.id&&i("")})),Object(j.jsx)("header",{id:"logout-wrapper",children:Object(j.jsxs)("p",{id:"logout",onClick:function(){i(""===a?"isExpanded":"")},children:["Welcome, ",t,Object(j.jsxs)("span",{id:"gravatar-button-wrapper",className:a,children:[Object(j.jsx)("button",{onClick:function(){return localStorage.removeItem("accessToken"),sessionStorage.removeItem("releases"),void(window.location.href="/")},children:"Logout"}),Object(j.jsx)("button",{onClick:function(){return sessionStorage.removeItem("releases"),void(window.location.href="/")},children:"Refresh"})]})]})})},g=function(e){var t=e.data,n=e.convertTimestamp,r=e.callApi,a=e.setIsLoading,i=Object(s.useState)(!1),c=Object(l.a)(i,2),o=c[0],d=c[1],b=function(){var e=window.localStorage.getItem("accessToken");try{e=JSON.parse(e)}catch(t){e=!1}return e},m=Object(u.l)();return window.addEventListener("click",(function(e){"btn-delete"!==e.target.className&&d(!1)})),Object(j.jsxs)("article",{children:[Object(j.jsxs)("header",{children:[Object(j.jsxs)("h4",{children:[t.signerName," - ",t.signerEmailAddress]}),Object(j.jsxs)("p",{className:"metadata",children:["Requested: ",n(1e3*t.createdAt)]}),t.signedAt&&Object(j.jsxs)("p",{className:"metadata",children:["Signed: ",n(1e3*t.signedAt)]})]}),Object(j.jsxs)("ul",{children:[Object(j.jsxs)("li",{children:["Subject: ",t&&t.subject]}),Object(j.jsxs)("li",{children:["Message: ",t&&t.message]})]}),!t.signedAt&&Object(j.jsxs)("div",{className:"signature-button-wrapper",children:[Object(j.jsx)("button",{onClick:function(){a(!0);var e=b();if(e){var n={action:"sendReminder",auth:{userId:e.userId,token:e.token},params:{requestId:t.id,emailAddress:t.signerEmailAddress}};r(n).then((function(e){a(!1),200===e.status&&(sessionStorage.removeItem("releases"),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Reminder sent!",setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3))})).catch((function(e){a(!1),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Unable to send reminder. Error: "+e.message,setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3)}))}},children:"Resend request"}),Object(j.jsx)("button",{onClick:function(){if(o){a(!0);var e=b();if(e){var n={action:"deleteRequest",auth:{userId:e.userId,token:e.token},params:{requestId:t.id}};r(n).then((function(e){a(!1),200===e.status&&(sessionStorage.removeItem("releases"),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Request deleted successfully!",setTimeout((function(){m("/")}),2e3))})).catch((function(e){a(!1),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Unable to delete request. Error: "+e.message,setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3)}))}}else d(!0)},className:"btn-delete",style:o?{backgroundColor:"salmon"}:{backgroundColor:"var(--dk-green)"},children:o?"Are you sure?":"Delete Request"})]}),t.signedAt&&Object(j.jsx)("div",{className:"signature-button-wrapper",children:Object(j.jsx)("button",{onClick:function(){a(!0);var e=b();if(e){var n={action:"getSignatureFile",auth:{userId:e.userId,token:e.token},params:{requestId:t.id}};r(n).then((function(e){return e.json()})).then((function(e){a(!1),window.open(e.fileUrl)}))}},children:"Download signed form"})})]})},h=function(e){var t=e.callApi,n=e.checkReleaseData,r=e.convertTimestamp,a=e.setIsLoading,i=e.sortSignatures,c=Object(u.n)().releaseId,o=Object(s.useState)(null),b=Object(l.a)(o,2),m=b[0],h=b[1],O=Object(s.useState)(null),f=Object(l.a)(O,2),p=f[0],x=f[1],y=Object(s.useState)(!1),v=Object(l.a)(y,2),S=v[0],I=v[1];Object(s.useEffect)((function(){var e=n();if(e){h(e[c]);var s=i(e[c].requestedSignatures);x(s)}else{var r=k();if(r){var a={action:"getAllReleases",auth:{userId:r.userId,token:r.token}};t(a).then((function(e){return e.json()})).then((function(e){h(e.Item.releases[c]);var t=i(e.Item.releases[c].requestedSignatures);x(t)}))}}}),[]);var k=function(){var e=window.localStorage.getItem("accessToken");try{e=JSON.parse(e)}catch(t){e=!1}return e},q=Object(u.l)();return window.addEventListener("click",(function(e){"btn-delete"!==e.target.className&&I(!1)})),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("header",{id:"release-header",children:[Object(j.jsx)(d.b,{to:"/",className:"back-link",children:"Back to All Releases"}),Object(j.jsx)("h2",{children:m&&m.title}),Object(j.jsx)("button",{className:"btn-delete",onClick:function(){if(S){if(p.signed.length>0)return document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Cannot delete releases with completed signatures. If you wish to delete pending signatures, you may do so one by one.",I(!1),void setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),4e3);a(!0);var e=k();if(e){var n={action:"deleteRelease",auth:{userId:e.userId,token:e.token},params:{releaseId:c}};t(n).then((function(e){a(!1),200===e.status&&(sessionStorage.removeItem("releases"),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Release deleted successfully!",setTimeout((function(){q("/")}),2e3))})).catch((function(e){a(!1),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Unable to delete release. Error: "+e.message,setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3)}))}}else I(!0)},style:S?{backgroundColor:"salmon"}:{backgroundColor:"var(--dk-green)"},children:S?"Are you sure?":"Delete Release"}),Object(j.jsxs)("p",{className:"metadata",children:["Created: ",m&&r(m.created)," ",Object(j.jsx)("br",{}),"Last Modified: ",m&&r(m.modified)]})]}),Object(j.jsxs)("section",{id:"release-general-info",children:[Object(j.jsx)("h3",{children:"Description"}),Object(j.jsx)("p",{children:m&&m.description}),Object(j.jsx)("h3",{children:"Sender info"}),Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:m&&"Name: "+m.senderInfo.name}),Object(j.jsx)("li",{children:m&&"Email: "+m.senderInfo.emailAddress})]})]}),Object(j.jsxs)("section",{id:"release-signatures",children:[Object(j.jsx)("h3",{children:"Signatures"}),Object(j.jsx)(d.b,{to:"/request-signatures/".concat(c),children:Object(j.jsx)("button",{children:"Request New Signature(s)"})}),Object(j.jsxs)("dl",{children:[p&&p.pending.length>0&&Object(j.jsxs)("dt",{children:["Pending (",p&&p.pending.length,")"]}),p&&p.pending.length>0&&p.pending.map((function(e,n){return Object(j.jsx)(g,{data:e,convertTimestamp:r,callApi:t,setIsLoading:a},n)})),p&&p.signed.length>0&&Object(j.jsxs)("dt",{children:["Signed (",p&&p.signed.length,")"]}),p&&p.signed.length>0&&p.signed.map((function(e,n){return Object(j.jsx)(g,{data:e,convertTimestamp:r,callApi:t,setIsLoading:a},n)}))]}),!p||0===p.pending.length&&0===p.signed.length?Object(j.jsx)("p",{id:"no-signatures",children:"No signatures requested yet."}):""]}),Object(j.jsx)("dialog",{id:"release-notification"})]})},O=function(e){var t=e.data,n=e.sortSignatures,s=e.convertTimestamp,r=n(t.requestedSignatures);return Object(j.jsxs)("article",{children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:t.title}),Object(j.jsxs)("div",{className:"release-thumbnails-dates",children:[Object(j.jsxs)("p",{children:["Created:",Object(j.jsx)("span",{children:s(t.created)})]}),Object(j.jsxs)("p",{children:["Last modified:",Object(j.jsx)("span",{children:s(t.modified)})]})]})]}),Object(j.jsx)("p",{className:"release-thumbnail-description",children:t.description}),Object(j.jsxs)("dl",{children:[Object(j.jsxs)("dd",{children:[r.pending.length+r.signed.length," signature requests"]}),r.pending.length>0&&Object(j.jsxs)("dd",{children:[r.pending.length," pending"]}),r.signed.length>0&&Object(j.jsxs)("dd",{children:[r.signed.length," completed"]})]})]})},f=function(e){e.userId,e.token;var t=e.callApi,n=e.checkReleaseData,r=e.setIsLoading,a=e.sortSignatures,i=e.convertTimestamp,c=Object(s.useState)(null),o=Object(l.a)(c,2),u=o[0],b=o[1];return Object(s.useEffect)((function(){var e=n();if(e)b(e);else{r(!0);var s=function(){var e=window.localStorage.getItem("accessToken");try{e=JSON.parse(e)}catch(t){e=!1}return e}();if(s){var a={action:"getAllReleases",auth:{userId:s.userId,token:s.token}};t(a).then((function(e){return e.json()})).then((function(e){sessionStorage.setItem("releases",JSON.stringify(e.Item.releases)),b(e.Item.releases),r(!1)}))}}}),[]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("header",{id:"all-releases",children:[Object(j.jsx)("h2",{children:"All Releases"}),Object(j.jsx)(d.b,{to:"/create",children:Object(j.jsx)("button",{children:"Create New Release"})})]}),Object(j.jsxs)("section",{id:"release-thumbnails",children:[u&&0===Object.keys(u).length&&Object(j.jsxs)("p",{children:["No releases found - click the ",Object(j.jsx)("strong",{children:"Create New Release"})," button to get started!"]}),u&&Object.keys(u).map((function(e){return Object(j.jsx)(d.b,{to:"/release/".concat(e),children:Object(j.jsx)(O,{data:u[e],sortSignatures:a,convertTimestamp:i})},e)}))]})]})},p=function(e){var t=e.callApi,n=e.setIsLoading,r=Object(s.useState)(""),a=Object(l.a)(r,2),i=a[0],c=a[1],o=Object(s.useState)(""),b=Object(l.a)(o,2),m=b[0],g=b[1],h=Object(s.useState)(""),O=Object(l.a)(h,2),f=O[0],p=O[1],x=Object(s.useState)(""),y=Object(l.a)(x,2),v=y[0],S=y[1],I=function(){n(!0);var e=function(){var e=window.localStorage.getItem("accessToken");try{e=JSON.parse(e)}catch(t){e=!1}return e}();if(e){var s={action:"saveRelease",auth:{userId:e.userId,token:e.token},params:{title:i,description:m,senderInfo:{name:f,emailAddress:v}}};t(s).then((function(e){200===e.status&&(sessionStorage.removeItem("releases"),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Release created successfully!",setTimeout((function(){k("/")}),2e3))})).catch((function(e){document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Unable to create release. Error: "+e.message,setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3)}))}},k=Object(u.l)();return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.b,{to:"/",className:"back-link",children:"Back to All Releases"}),Object(j.jsx)("h2",{children:"Create a Release"}),Object(j.jsxs)("form",{id:"create-release",children:[Object(j.jsxs)("section",{children:[Object(j.jsx)("h3",{children:"Release Info"}),Object(j.jsx)("label",{htmlFor:"title",children:"Title"}),Object(j.jsx)("input",{type:"text",id:"title",name:"title",value:i,onChange:function(e){return c(e.target.value)},required:!0}),Object(j.jsx)("label",{htmlFor:"description",children:"Description"}),Object(j.jsx)("textarea",{id:"description",name:"description",value:m,onChange:function(e){return g(e.target.value)},required:!0})]}),Object(j.jsxs)("section",{children:[Object(j.jsx)("h3",{children:"Sender Info"}),Object(j.jsx)("p",{children:"This info will be used to identify you in:"}),Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:"signature request emails"}),Object(j.jsx)("li",{children:"media release contract"})]}),Object(j.jsx)("label",{htmlFor:"sender-name",children:"Name"}),Object(j.jsx)("input",{type:"text",id:"sender-name",name:"sender-name",value:f,onChange:function(e){return p(e.target.value)},required:!0}),Object(j.jsx)("label",{htmlFor:"sender-email",children:"Email"}),Object(j.jsx)("input",{type:"email",id:"sender-email",name:"sender-email",value:v,onChange:function(e){return S(e.target.value)},required:!0})]}),Object(j.jsx)("button",{onClick:function(e){e.preventDefault(),I()},children:"Create Release"})]}),Object(j.jsx)("dialog",{id:"release-notification",children:"Release created successfully!"})]})},x=n(7),y=function(e){var t=e.callApi,n=e.checkReleaseData,r=e.setIsLoading,a=Object(u.n)().releaseId,i=Object(s.useState)(""),c=Object(l.a)(i,2),o=c[0],b=c[1],m=Object(s.useState)(""),g=Object(l.a)(m,2),h=g[0],O=g[1],f=Object(s.useState)([{name:"",emailAddress:""}]),p=Object(l.a)(f,2),y=p[0],v=p[1],S=function(e){var t="object"===typeof e,n=2===Object.keys(e).length,s=e.hasOwnProperty("emailAddress")&&/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e.emailAddress),r=e.hasOwnProperty("name")&&/^[a-zA-Z0-9.' ]{1,}$/.test(e.name);return t&&n&&s&&r},I=function(){var e=function(){var e=window.localStorage.getItem("accessToken");try{e=JSON.parse(e)}catch(t){e=!1}return e}();if(e){r(!0);var s=n(),i=Object(x.a)(y).filter(S),c={action:"signatureRequest",auth:{userId:e.userId,token:e.token},params:{releaseId:a,senderInfo:s[a].senderInfo,subject:o,message:h,signerInfo:i}};t(c).then((function(e){r(!1),200===e.status&&(sessionStorage.removeItem("releases"),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Signature(s) requested!",setTimeout((function(){k("/")}),2e3))})).catch((function(e){r(!1),document.querySelector("#release-notification").style.display="grid",document.querySelector("#release-notification").innerText="Unable to request signature(s). Error: "+e.message,setTimeout((function(){document.querySelector("#release-notification").style.display="none"}),2e3)}))}},k=Object(u.l)();return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.b,{to:"/release/".concat(a),className:"back-link",children:"Cancel signature request"}),Object(j.jsx)("h2",{children:"Request Signature(s)"}),Object(j.jsxs)("form",{id:"request-new-signature",children:[Object(j.jsxs)("section",{children:[Object(j.jsx)("h3",{children:"General Info"}),Object(j.jsx)("label",{htmlFor:"subject",children:"Subject:"}),Object(j.jsx)("input",{type:"text",id:"subject",name:"subject",value:o,onChange:function(e){return b(e.target.value)},required:!0}),Object(j.jsx)("label",{htmlFor:"message",children:"Message:"}),Object(j.jsx)("textarea",{id:"message",name:"message",value:h,onChange:function(e){return O(e.target.value)},required:!0})]}),Object(j.jsxs)("section",{children:[Object(j.jsx)("h3",{children:"Signer Info"}),y&&y.map((function(e,t){return Object(j.jsxs)("div",{className:"signer-info-row",children:[Object(j.jsxs)("div",{className:"input-wrapper",children:[Object(j.jsx)("label",{htmlFor:"signer-name-"+t,children:"Name:"}),Object(j.jsx)("input",{type:"text",id:"signer-name-"+t,name:"signer-name-"+t,value:e.name,onChange:function(e){var n=Object(x.a)(y);n[t].name=e.target.value,v(n)},required:!0})]}),Object(j.jsxs)("div",{className:"input-wrapper",children:[Object(j.jsx)("label",{htmlFor:"signer-email-"+t,children:"Email:"}),Object(j.jsx)("input",{type:"email",id:"signer-email-"+t,name:"signer-email-"+t,value:e.emailAddress,onChange:function(e){var n=Object(x.a)(y);n[t].emailAddress=e.target.value,v(n)},required:!0})]})]},t)})),Object(j.jsx)("button",{onClick:function(e){return function(e){e.preventDefault();var t=Object(x.a)(y);t.push({name:"",emailAddress:""}),v(t)}(e)},children:"Add Signer"})]}),Object(j.jsx)("button",{onClick:function(e){e.preventDefault(),I()},children:"Make Request"})]}),Object(j.jsx)("dialog",{id:"release-notification"})]})},v=function(){var e=new Date;return Object(j.jsxs)("footer",{children:["\xa9 Copyright ",e.getFullYear()," - Chad O'Brien"]})},S=function(e){var t=e.isVisible?{display:"grid"}:{display:"none"};return Object(j.jsx)("dialog",{id:"loading-modal",style:t,children:Object(j.jsx)("p",{children:"Loading..."})})},I=function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],a=Object(s.useState)(null),i=Object(l.a)(a,2),g=i[0],O=i[1],x=Object(s.useState)(null),I=Object(l.a)(x,2),k=I[0],q=I[1],w=Object(s.useState)(""),N=Object(l.a)(w,2),T=N[0],A=N[1],R=Object(s.useState)(!1),C=Object(l.a)(R,2),L=C[0],D=C[1],E=function(){var e=sessionStorage.getItem("releases"),t=null;try{t=JSON.parse(e)}catch(n){console.error(n)}return t},F=function(e){var t={pending:[],signed:[]};return e.forEach((function(e){e.signatures.forEach((function(n){switch(n.createdAt=e.createdAt,n.subject=e.subject,n.message=e.message,n.id=e.signatureRequestId,n.statusCode){case"awaiting_signature":t.pending.push(n);break;case"signed":t.signed.push(n);break;default:return}}))})),t},J=function(){var e=Object(o.a)(Object(c.a)().mark((function e(t){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://824oc9yvf6.execute-api.us-east-2.amazonaws.com/prod/releaseme",e.next=3,fetch("https://824oc9yvf6.execute-api.us-east-2.amazonaws.com/prod/releaseme",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){return new Date(e).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})};return Object(s.useEffect)((function(){var e=function(){var e={success:!1},t=window.localStorage.getItem("accessToken");if(null===t)return e.message="No access token found in local storage",e;try{t=JSON.parse(t)}catch(n){return e.message="Ineligble access token: improper format",e}return t.expiry?t.expiry<Date.now()?(e.success=!1,e.message="Ineligble access token: expired",e):t.userId?t.token?t.userName?(O(t.userId),q(t.token),A(t.userName),e.success=!0,e):(e.message="Ineligble access userName: missing userName",e):(e.message="Ineligble access token: missing token",e):(e.message="Ineligble access token: missing userId",e):(e.message="Ineligble access token: missing expiry",e)}();r(e.success)}),[]),Object(j.jsxs)(j.Fragment,{children:[n&&Object(j.jsx)(m,{userName:T,setIsLoading:D}),Object(j.jsx)(S,{isVisible:L}),Object(j.jsx)(d.a,{children:Object(j.jsxs)(u.c,{children:[Object(j.jsx)(u.a,{exact:!0,path:"/",element:n?Object(j.jsx)(f,{userId:g,token:k,callApi:J,checkReleaseData:E,convertTimestamp:U,setIsLoading:D,sortSignatures:F}):Object(j.jsx)(b,{setIsLoggedIn:r,setUserId:O,setToken:q,setUserName:A,setIsLoading:D})}),Object(j.jsx)(u.a,{path:"release/:releaseId",element:Object(j.jsx)(h,{callApi:J,checkReleaseData:E,convertTimestamp:U,setIsLoading:D,sortSignatures:F})}),Object(j.jsx)(u.a,{path:"create",element:Object(j.jsx)(p,{callApi:J,setIsLoading:D})}),Object(j.jsx)(u.a,{path:"request-signatures/:releaseId",element:Object(j.jsx)(y,{callApi:J,checkReleaseData:E,setIsLoading:D})})]})}),Object(j.jsx)(v,{})]})};i.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsxs)("main",{children:[Object(j.jsx)("h1",{className:"sr-only",children:"Release Me | Media Release Form Manager"}),Object(j.jsx)(I,{})]})}),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.64665258.chunk.js.map